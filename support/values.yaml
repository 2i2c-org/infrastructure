cluster-autoscaler:
  enabled: false
ingress-nginx:
  controller:
    podLabels:
      hub.jupyter.org/network-access-proxy-http: 'true'
prometheus:
  networkPolicy:
    enabled: true
  alertmanager:
    enabled: false
  nodeExporter:
    tolerations:
      - effect: NoSchedule
        # Deploy onto user nodes
        key: hub.jupyter.org_dedicated
        value: user
      - effect: NoSchedule
        # Deploy onto user nodes
        key: k8s.dask.org_dedicated
        value: worker
    updateStrategy:
      type: RollingUpdate
  pushgateway:
    enabled: false
  server:
    resources:
      # Without this, prometheus can easily starve users
      requests:
        cpu: 0.2
        memory: 512Mi
      limits:
        cpu: 1
        memory: 2Gi
    labels:
      # For HTTP access to the hub, to scrape metrics
      hub.jupyter.org/network-access-hub: 'true'
    persistentVolume:
      size: 100Gi
    retention: 90d
    service:
      type: ClusterIP

grafana:
  persistence:
    storageClassName: standard
  deploymentStrategy:
    type: Recreate

  persistence:
    enabled: true
  service:
    type: ClusterIP

  ingress:
    enabled: true
    annotations:
      kubernetes.io/ingress.class: nginx
      cert-manager.io/cluster-issuer: letsencrypt-prod

  datasources:
    datasources.yaml:
      apiVersion: 1
      datasources:
        - name: prometheus
          orgId: 1
          type: prometheus
          url: http://support-prometheus-server
          access: proxy
          isDefault: true
          editable: false

# Values reference for nfs-server-provisioner
# https://github.com/kubernetes-sigs/nfs-ganesha-server-and-external-provisioner/blob/master/deploy/helm/values.yaml
nfs-server-provisioner:
  enabled: false
  storageClass:
    # Users will have to opt-in to using NFS-type storage under
    # singleuser.storage.dynamic.storageClass
    name: incluster-nfs
    create: true
    defaultClass: false
    mountOptions:
      - vers=4.2
      - soft
      - noatime
  persistence:
    enabled: true
    accessMode: ReadWriteOnce
    size: 100Gi
    # Future option is to reference an xfs storage class. This will allow us to enable quotas.
    # https://github.com/pangeo-data/pangeo-cloud-federation/issues/654#issuecomment-861771398
    # https://cloud.google.com/kubernetes-engine/docs/how-to/persistent-volumes/gce-pd-csi-driver
    storageClass: standard
