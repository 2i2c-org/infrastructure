basehub:
  userServiceAccount:
    annotations:
      iam.gke.io/gcp-service-account: pangeo-hubs-coessing@pangeo-integration-te-3eea.iam.gserviceaccount.com
  jupyterhub:
    custom:
      2i2c:
        add_staff_user_ids_to_admin_users: true
        add_staff_user_ids_of_type: "google"
    singleuser:
      extraEnv:
        SCRATCH_BUCKET: gcs://pangeo-hubs-coessing-scratch/$(JUPYTERHUB_USER)
        PANGEO_SCRATCH: gcs://pangeo-hubs-coessing-scratch/$(JUPYTERHUB_USER)
      # No profiles
      profileList: null
      memory:
        limit: 7G
        guarantee: 4.5G
      nodeSelector:
        node.kubernetes.io/instance-type: n1-standard-2
    hub:
      config:
        Authenticator:
          admin_users: &admin_users
            - paigemar@umich.edu
          allowed_users: *admin_users
          # Delete any prior existing users in the db that don't pass username_pattern
          delete_invalid_users: true
        JupyterHub:
          authenticator_class: cilogon
        CILogonOAuthenticator:
          oauth_callback_url: "https://coessing.2i2c.cloud/hub/oauth_callback"
          # Only show the option to login with Google
          shown_idps:
            - https://accounts.google.com/o/oauth2/auth
          allowed_idps:
            # CILogon still uses the old google oidc enpoint instead of the new one listed in `shown_idps`.
            # Ref https://github.com/ncsa/OA4MP/issues/45
            http://google.com/accounts/o8/id:
              username_derivation:
                username_claim: "email"
# TODO:
# - setup scratch-bucket
# - No profiles, just set to medium
# - Wait on Julia
# - Push to GitHub
