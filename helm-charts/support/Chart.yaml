apiVersion: v2
name: support
version: "0.1.0"
description: Cluster wide dependencies for deployed hubs

dependencies:
  # Prometheus for collection of metrics.
  # https://github.com/prometheus-community/helm-charts/tree/main/charts/prometheus
  #
  # We have deliberately chosen to use the helm chart rather than the prometheus
  # operator, as we will never have more than one prometheus installation per
  # cluster. The operator thus adds functionality we will not use, at a complexity
  # cost. If we ever have multiple prometheii on the same cluster, we can
  # reconsider using the operator.
  - name: prometheus
    version: 28.9.0
    repository: https://prometheus-community.github.io/helm-charts

  # Grafana for dashboarding of metrics.
  # https://github.com/grafana/helm-charts/tree/main/charts/grafana
  - name: grafana
    version: 10.2.0
    repository: https://grafana.github.io/helm-charts

  # ingress-nginx for a k8s Ingress resource controller that routes traffic from
  # a single IP entrypoint to various services exposed via k8s Ingress resources
  # that references this controller.
  # https://github.com/kubernetes/ingress-nginx/tree/main/charts/ingress-nginx
  - name: ingress-nginx
    version: 4.14.3
    repository: https://kubernetes.github.io/ingress-nginx

  # This is the ingress maintained by nginx, rather than the one maintained by the
  # kubernetes community. We switch to this to have least potential disruption
  # possible, until we eventually perhaps move to the Gateway API someday
  - name: nginx-ingress
    version: 2.4.4
    repository: oci://ghcr.io/nginx/charts
    condition: nginx-ingress.enabled

  # cluster-autoscaler for k8s clusters where it doesn't come out of the box (EKS)
  # https://github.com/kubernetes/autoscaler/tree/master/charts/cluster-autoscaler
  - name: cluster-autoscaler
    version: 9.52.1
    repository: https://kubernetes.github.io/autoscaler
    condition: cluster-autoscaler.enabled

  # cryptnono, counters crypto mining
  # https://github.com/cryptnono/cryptnono/
  - name: cryptnono
    version: "0.3.2-0.dev.git.217.hbcd17ea"
    repository: https://cryptnono.github.io/cryptnono/
    condition: cryptnono.enabled

  # jupyterhub-cost-monitoring, cost reporting for Grafana
  # https://github.com/2i2c-org/jupyterhub-cost-monitoring
  - name: jupyterhub-cost-monitoring
    version: "v1.1.1"
    repository: https://2i2c.org/jupyterhub-cost-monitoring/
    condition: jupyterhub-cost-monitoring.enabled

  # Provide metrics about GPU usage
  # https://github.com/NVIDIA/dcgm-exporter
  - name: dcgm-exporter
    version: 3.6.1
    repository: https://nvidia.github.io/dcgm-exporter/helm-charts
