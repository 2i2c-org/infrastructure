basehub:
  nfs:
    pv:
      serverIP: 10.100.130.27
  jupyterhub:
    custom:
      2i2c:
        add_staff_user_ids_to_admin_users: false
      homepage:
        # Remove once https://github.com/2i2c-org/default-hub-homepage/pull/51
        # is merged
        gitRepoBranch: unify-logins-2
      singleuserAdmin:
        extraVolumeMounts: []
    ingress:
      hosts: [workshop.openscapes.2i2c.cloud]
      tls:
      - hosts: [workshop.openscapes.2i2c.cloud]
        secretName: https-auto-tls
    hub:
      allowNamedServers: true
      config:
        JupyterHub:
          authenticator_class: dummy
        Authenticator:
          enable_auth_state: false
          manage_groups: false
          admin_users: []
    singleuser:
      initContainers:
      - name: volume-mount-ownership-fix
        image: busybox:1.36.1
        command:
        - sh
        - -c
        - id && chown 1000:1000 /home/jovyan /home/jovyan/shared-public && ls -lhd /home/jovyan
        securityContext:
          runAsUser: 0
        volumeMounts:
        - name: home
          mountPath: /home/jovyan
          subPath: '{escaped_username}'
        - name: home
          mountPath: /home/jovyan/shared-public
          subPath: _shared-public
      storage:
        extraVolumeMounts:
          # A shared folder readable & writeable by everyone
        - name: home
          mountPath: /home/jovyan/shared-public
          subPath: _shared-public
          readOnly: false
      nodeSelector:
        2i2c/hub-name: workshop
      extraEnv:
        SCRATCH_BUCKET: s3://openscapeshub-scratch-workshop/$(JUPYTERHUB_USER)
        PERSISTENT_BUCKET: s3://openscapeshub-persistent-workshop/$(JUPYTERHUB_USER)
      profileList:
      - display_name: Choose your environment and resources
        default: true
        profile_options:
          image:
            display_name: Environment
            dynamic_image_building:
              enabled: true
            unlisted_choice:
              enabled: true
              display_name: Custom image
              description: Specify your own docker image (must have python and jupyterhub installed in it)
              validation_regex: ^.+:.+$
              validation_message: Must be a publicly available docker image, of form <image-name>:<tag>
              kubespawner_override:
                image: '{value}'
            choices:
              01-python:
                display_name: Python
                description: Python datascience environment
                kubespawner_override:
                  image: openscapes/python:7093bd3
              02-R:
                display_name: R + Python Geospatial
                description: Py-R - Geospatial + QGIS, Panoply, CWUtils - py-rocket-geospatial-2 latest
                kubespawner_override:
                  image: ghcr.io/nmfs-opensci/container-images/py-rocket-geospatial-2:latest
              03-Matlab:
                display_name: Matlab
                description: Matlab environment
                kubespawner_override:
                  image: openscapes/matlab:2023-11-28

              04-OceanData:
                display_name: Oceandata
                kubespawner_override:
                  image: ghcr.io/nasa/oceandata-notebooks:latest
                default: true

          resource_allocation:
            display_name: Resource Allocation
            choices:
              mem_2_gb:
                display_name: ~2 GB RAM, ~0.2 CPUs
                description: Up to ~4 CPUs when available
                kubespawner_override:
                  mem_guarantee: 1951419879
                  mem_limit: 1951419879
                  cpu_guarantee: 0.22815625
                  cpu_limit: 3.6505
                  node_selector:
                    node.kubernetes.io/instance-type: r5.xlarge
              mem_4_gb:
                display_name: ~4 GB RAM, ~0.5 CPUs
                description: Up to ~4 CPUs when available
                kubespawner_override:
                  mem_guarantee: 3902839759
                  mem_limit: 3902839759
                  cpu_guarantee: 0.4563125
                  cpu_limit: 3.6505
                  node_selector:
                    node.kubernetes.io/instance-type: r5.xlarge
              mem_7_gb:
                display_name: ~7 GB RAM, ~0.9 CPUs
                description: Up to ~4 CPUs when available
                kubespawner_override:
                  mem_guarantee: 7805679519
                  mem_limit: 7805679519
                  cpu_guarantee: 0.912625
                  cpu_limit: 3.6505
                  node_selector:
                    node.kubernetes.io/instance-type: r5.xlarge
              mem_15_gb:
                display_name: ~15 GB RAM, ~1.8 CPUs
                description: Up to ~4 CPUs when available
                kubespawner_override:
                  mem_guarantee: 15611359038
                  mem_limit: 15611359038
                  cpu_guarantee: 1.82525
                  cpu_limit: 3.6505
                  node_selector:
                    node.kubernetes.io/instance-type: r5.xlarge
              mem_29_gb:
                display_name: ~29 GB RAM, ~4 CPUs
                description: ~4 CPUs always available
                kubespawner_override:
                  mem_guarantee: 31222718077
                  mem_limit: 31222718077
                  cpu_guarantee: 3.6505
                  cpu_limit: 3.6505
                  node_selector:
                    node.kubernetes.io/instance-type: r5.xlarge
              mem_60_gb:
                display_name: ~60 GB RAM, ~8 CPUs
                description: Up to ~15 CPUs when available
                kubespawner_override:
                  mem_guarantee: 64020707016
                  mem_limit: 64020707016
                  cpu_guarantee: 7.69055
                  cpu_limit: 15.3811
                  node_selector:
                    node.kubernetes.io/instance-type: r5.4xlarge
              mem_119_gb:
                display_name: ~119 GB RAM, ~15 CPUs
                description: ~15 CPUs always available
                kubespawner_override:
                  mem_guarantee: 128041414033
                  mem_limit: 128041414033
                  cpu_guarantee: 15.3811
                  cpu_limit: 15.3811
                  node_selector:
                    node.kubernetes.io/instance-type: r5.4xlarge

  dask-gateway:
    gateway:
      backend:
        scheduler:
          extraPodConfig:
            nodeSelector:
              2i2c/hub-name: workshop
        worker:
          extraPodConfig:
            nodeSelector:
              2i2c/hub-name: workshop
  jupyterhub-home-nfs:
    quotaEnforcer:
      config:
        QuotaManager:
          hard_quota: 10
    eks:
      volumeId: vol-0ab191452f5c85c6b
